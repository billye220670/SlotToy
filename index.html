<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>æ°´æœè€è™æœº</title>  
    <script src="https://cdn.tailwindcss.com"></script>  
    <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>  
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>  
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>  
    <style>  
        @keyframes vertical-spin {  
            0% { transform: translateY(-100%); opacity: 0.5; }  
            100% { transform: translateY(0); opacity: 1; }  
        }  
        .slot-spin {  
            animation: vertical-spin 0.5s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;  
        }  
        body {  
            touch-action: manipulation;  
            overscroll-behavior-y: contain;  
        }  
    </style>  
</head>  
<body>  
    <div id="root"></div>  

    <script type="text/babel">  
        // éŸ³æ•ˆèµ„æº  
        const SOUND_URLS = {  
            spin: 'https://raw.githubusercontent.com/mdn/learning-area/master/javascript/building-blocks/audio-video-media/media/button-press.mp3',  
            win: 'https://raw.githubusercontent.com/mdn/learning-area/master/javascript/building-blocks/audio-video-media/media/ding.mp3'  
        };  

        // è€è™æœºå›¾æ ‡ï¼ˆçº¯æ°´æœä¸»é¢˜ï¼‰  
        const SYMBOLS = [  
            'ğŸ', 'ğŸ', 'ğŸŠ', 'ğŸ‹',   
            'ğŸŒ', 'ğŸ‰', 'ğŸ‡', 'ğŸ“',   
            'ğŸ¥', 'ğŸ’', 'ğŸ', 'ğŸˆ'  
        ];  

        const SlotColumn = ({ symbols, isSpinning }) => {  
            return (  
                <div className="flex flex-col items-center w-16 sm:w-24 h-64 sm:h-96 overflow-hidden border-2 rounded-lg shadow-md">  
                    {symbols.map((symbol, index) => (  
                        <div   
                            key={index}   
                            className={`  
                                text-3xl sm:text-5xl h-16 sm:h-24 w-full flex items-center justify-center   
                                ${isSpinning ? 'slot-spin' : ''}  
                                border-b last:border-b-0 transition-all  
                                ${index === 2 ? 'bg-yellow-50' : ''}  
                            `}  
                        >  
                            {symbol}  
                        </div>  
                    ))}  
                </div>  
            );  
        };  

        const SlotMachine = () => {  
            // éŸ³æ•ˆçŠ¶æ€  
            const [sounds, setSounds] = React.useState({  
                spin: null,  
                win: null  
            });  

            // 4ä¸ªè½®ç›˜ï¼Œæ¯ä¸ªè½®ç›˜4ä¸ªå›¾æ ‡  
            const [slots, setSlots] = React.useState(  
                Array(4).fill().map(() => ({  
                    symbols: [  
                        SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)],  
                        SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)],  
                        SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)],  
                        SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)]  
                    ],  
                    isSpinning: false  
                }))  
            );  

            const [isSpinning, setIsSpinning] = React.useState(false);  
            const [balance, setBalance] = React.useState(5000);  

            // é¢„åŠ è½½éŸ³æ•ˆ  
            React.useEffect(() => {  
                const loadSound = async (url) => {  
                    try {  
                        const response = await fetch(url);  
                        const blob = await response.blob();  
                        const audioUrl = URL.createObjectURL(blob);  
                        return new Audio(audioUrl);  
                    } catch (error) {  
                        console.error('éŸ³æ•ˆåŠ è½½å¤±è´¥:', url, error);  
                        return null;  
                    }  
                };  

                const loadSounds = async () => {  
                    const spinSound = await loadSound(SOUND_URLS.spin);  
                    const winSound = await loadSound(SOUND_URLS.win);  
                    
                    setSounds({  
                        spin: spinSound,  
                        win: winSound  
                    });  
                };  

                loadSounds();  
            }, []);  

            const playSound = (soundType) => {  
                const sound = sounds[soundType];  
                if (sound) {  
                    try {  
                        sound.currentTime = 0;  
                        sound.play().catch(error => {  
                            console.log(`${soundType}éŸ³æ•ˆæ’­æ”¾é”™è¯¯:`, error);  
                        });  
                    } catch (error) {  
                        console.log(`${soundType}éŸ³æ•ˆæ’­æ”¾å¼‚å¸¸:`, error);  
                    }  
                }  
            };  

            const spinSlots = () => {  
                if (isSpinning || balance < 50) return;  

                // æ’­æ”¾æ—‹è½¬éŸ³æ•ˆ  
                playSound('spin');  

                setBalance(prev => prev - 50);  
                setIsSpinning(true);  

                // ç”Ÿæˆæ–°çš„è½®ç›˜å›¾æ ‡  
                const newSlots = slots.map(() => ({  
                    symbols: [  
                        SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)],  
                        SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)],  
                        SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)],  
                        SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)]  
                    ],  
                    isSpinning: true  
                }));  

                // æ¨¡æ‹Ÿè½®ç›˜æ—‹è½¬  
                slots.forEach((_, index) => {  
                    setTimeout(() => {  
                        setSlots(prevSlots => {  
                            const updatedSlots = [...prevSlots];  
                            updatedSlots[index] = newSlots[index];  
                            return updatedSlots;  
                        });  
                    }, 200 * (index + 1));  
                });  

                // åœæ­¢æ—‹è½¬å’Œå¥–åŠ±è®¡ç®—  
                setTimeout(() => {  
                    // è®¡ç®—ä¸­å¥–é€»è¾‘ï¼ˆä»¥ç¬¬ä¸‰è¡Œä¸ºå‡†ï¼‰  
                    const middleSymbols = newSlots.map(slot => slot.symbols[2]);  
                    const symbolCounts = {};  
                    
                    middleSymbols.forEach(symbol => {  
                        symbolCounts[symbol] = (symbolCounts[symbol] || 0) + 1;  
                    });  

                    const maxCount = Math.max(...Object.values(symbolCounts));  
                    let prize = 0;  

                    if (maxCount === 4) {  
                        prize = 5000;  
                        // æ’­æ”¾ä¸­å¥–éŸ³æ•ˆ  
                        playSound('win');  
                        alert(`ğŸ‰ è¶…çº§å¤§å¥–ï¼å…¨éƒ¨ç›¸åŒï¼å¥–é‡‘ +${prize}`);  
                    } else if (maxCount === 3) {  
                        prize = 1000;  
                        alert(`ğŸŒŸ å¤§å¥–ï¼3ä¸ªç›¸åŒï¼å¥–é‡‘ +${prize}`);  
                    } else if (maxCount === 2) {  
                        prize = 200;  
                        alert(`âœ¨ ä¸­å¥–ï¼2ä¸ªç›¸åŒï¼å¥–é‡‘ +${prize}`);  
                    }  

                    setBalance(prev => prev + prize);  
                    setIsSpinning(false);  
                    
                    // æ›´æ–°è½®ç›˜çŠ¶æ€  
                    setSlots(newSlots.map(slot => ({ ...slot, isSpinning: false })));  
                }, 2000);  
            };  

            return (  
                <div className="flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-green-100 to-yellow-100 p-4">  
                    <div className="bg-white p-4 sm:p-8 rounded-2xl shadow-2xl text-center w-full max-w-md">  
                        <h1 className="text-2xl sm:text-4xl font-bold mb-4 sm:mb-6 text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-yellow-600">  
                            æ°´æœè€è™æœº  
                        </h1>  
                        
                        {/* ä½™é¢æ˜¾ç¤º */}  
                        <div className="mb-4 sm:mb-6 text-xl sm:text-2xl font-semibold flex justify-center items-center">  
                            <span className="mr-2 sm:mr-4">ğŸ’° å½“å‰ä½™é¢:</span>  
                            <span className="bg-green-100 px-2 sm:px-4 py-1 sm:py-2 rounded-full text-green-800">  
                                {balance} é‡‘å¸  
                            </span>  
                        </div>  

                        {/* è½®ç›˜åŒºåŸŸ */}  
                        <div className="grid grid-cols-4 gap-2 sm:gap-4 mb-4 sm:mb-6 justify-center">  
                            {slots.map((slot, index) => (  
                                <SlotColumn   
                                    key={index}   
                                    symbols={slot.symbols}   
                                    isSpinning={slot.isSpinning}   
                                />  
                            ))}  
                        </div>  

                        {/* ä¸­å¥–çº¿ */}  
                        <div className="relative w-full mb-4">  
                            <div className="absolute left-0 right-0 flex justify-center">  
                                <div className="h-1 w-full max-w-3xl bg-red-500 opacity-50"></div>  
                            </div>  
                        </div>  

                        {/* æ—‹è½¬æŒ‰é’® */}  
                        <button   
                            onClick={spinSlots}   
                            disabled={isSpinning || balance < 50}  
                            className={`  
                                w-full py-2 sm:py-3 rounded-lg text-white font-bold text-lg sm:text-xl  
                                ${isSpinning || balance < 50   
                                    ? 'bg-gray-400 cursor-not-allowed'   
                                    : 'bg-gradient-to-r from-green-500 to-yellow-500 hover:from-green-600 hover:to-yellow-600'}  
                                transition-all duration-300  
                            `}  
                        >  
                            {balance < 50   
                                ? 'ä½™é¢ä¸è¶³'   
                                : (isSpinning ? 'æ—‹è½¬ä¸­...' : 'å¼€å§‹æ—‹è½¬ (50é‡‘å¸)')  
                            }  
                        </button>  

                        {/* æ¸¸æˆè¯´æ˜ */}  
                        <div className="mt-4 sm:mt-6 text-xs sm:text-sm text-gray-600 bg-gray-50 p-2 sm:p-4 rounded-lg">  
                            <p className="font-bold mb-1 sm:mb-2">ğŸ† å¥–åŠ±è§„åˆ™ï¼š</p>  
                            <p>ğŸ¥‡ 4ä¸ªç›¸åŒï¼šè¶…çº§å¤§å¥– +5000é‡‘å¸</p>  
                            <p>ğŸ¥ˆ 3ä¸ªç›¸åŒï¼šå¤§å¥– +1000é‡‘å¸</p>  
                            <p>ğŸ¥‰ 2ä¸ªç›¸åŒï¼šä¸­å¥– +200é‡‘å¸</p>  
                            <p className="text-red-500 mt-1 sm:mt-2">æ¯æ¬¡æ—‹è½¬æ‰£é™¤50é‡‘å¸</p>  
                            <p className="text-blue-500">ä»¥ç¬¬ä¸‰è¡Œä¸ºä¸­å¥–åˆ¤å®šçº¿</p>  
                        </div>  
                    </div>  
                </div>  
            );  
        };  

        // æ¸²æŸ“åº”ç”¨  
        ReactDOM.render(<SlotMachine />, document.getElementById('root'));  
    </script>  
</body>  
</html>  
